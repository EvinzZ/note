# MySQL存储引擎

## 1.存储引擎

### 1.1.InnoDB存储引擎

InnoDB是MySQL的默认事务型引擎。它被设计用来处理大量的短期事务，应该优先考虑InnoDB引擎。

### 1.2.MyISAM存储引擎

在MySQL5.1及之前的版本，MyISAM是默认的存储引擎。

但是MyISAM不支持事务和行级锁，而且崩溃后无法安全恢复。

同时MyISAM对整张表加锁，很容易因为表锁的问题导致典型的性能问题。

### 1.3.Memory引擎

Memory表至少比MyISAM表要快一个数量级，数据文件是存储在内存中。

Memory表的结构在重启以后还会保留，但数据会丢失。

Memory表在很多场景可以发挥好的作用：

用于查找或者映射表，例如将邮编和洲名映射的表。

用于缓存周期性聚合数据的结果

用于保存数据分析中产生的中间数据

### 1.4.Archive引擎

Archivne存储引擎只支持INSERT和SELECT操作，会缓存所有的写并利用zlib对插入的行进行压缩，所以比MyISAM表的磁盘I/O更少。但是每次SELECT查询都需要执行全表扫描。

所以Archive表适合日志和数据采集类应用。

### 1.5.CSV引擎

CSV引擎可以将普通的CSV文件（逗号分隔值的文件）作为MySQL的表来处理，但这种表不支持索引。

因此CSV引擎可以作为一种数据交换的机制，非常有用。

## 2.MyISAM和InnoDB的区别

**InnoDB支持事务，MyISAM不支持事务**

>  这是Mysql将默认存储引擎从MyISAM编程InnoDB的重要原因之一；

**InnoDB支持外键，而MyISAM不支持**

> 对一个包含外键的InnoDB表转为MyISAM会失败；

**InnoDB是聚集索引，MyISAM是非聚集索引**

>  聚簇索引的文件存放在主键索引的叶子节点上，因此InnoDB必须要有主键，通过主键索引效率很高。但是辅助索引需要两次查询，先查询到主键，然后再通过主键查询到数据。因此，主键不应该过大，因为主键太大，其他索引也都会很大。

> 而MyISAM是非聚集索引，数据文件都是分离的，索引保存的是数据文件的指针。主键索引和辅助索引是独立的。

**InnoDB不保存表的具体行数，执行select count(*) from table时需要全表扫描。而MyISAM用一个变量保存了整个表的行数，执行上述语句的只需要读出该变量即可，速度很快。**

**InnoDB最小的锁粒度是行锁，MyISAM最小的锁粒度是表锁。**

>  一个更新语句会锁住整张表，导致其他查询和更新都会被阻塞，因此并发访问受限。

